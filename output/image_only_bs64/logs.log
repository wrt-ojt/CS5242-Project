2025-04-19 20:48:09,396 [INFO] Logging setup complete.
2025-04-19 20:48:09,396 [INFO] Starting experiment: image_only_bs64
2025-04-19 20:48:09,396 [INFO] Configuration:
{
    "raw_data_dir": "/Users/yefangda/Learning/Courses/Sem2/CS5242/Project/CS5242-Project/raw_data",
    "label_file": "/Users/yefangda/Learning/Courses/Sem2/CS5242/Project/CS5242-Project/label.csv",
    "preprocessed_data_dir": "/Users/yefangda/Learning/Courses/Sem2/CS5242/Project/CS5242-Project/preprocessed_data",
    "output_dir": "/Users/yefangda/Learning/Courses/Sem2/CS5242/Project/CS5242-Project/output",
    "experiment_name": "image_only_bs64",
    "force_preprocess": false,
    "clip_model_name": "openai/clip-vit-base-patch32",
    "modality": "image",
    "freeze_clip": true,
    "projection_dim": null,
    "use_cross_attention": true,
    "num_attention_heads": 8,
    "use_cnn_layer": false,
    "cnn_out_channels_ratio": 0.5,
    "classifier_hidden_layers": [
        1024,
        512
    ],
    "num_classes": 3,
    "device": "cpu",
    "batch_size": 64,
    "num_epochs": 20,
    "learning_rate_clip": 1e-06,
    "learning_rate_head": 0.0001,
    "weight_decay_clip": 0.01,
    "weight_decay_head": 0.01,
    "dropout_attention": 0.1,
    "dropout_mlp": 0.4,
    "early_stopping_patience": 5,
    "num_workers": 4,
    "val_split_ratio": 0.15,
    "test_split_ratio": 0.15,
    "seed": 42,
    "max_token_length": 77,
    "label_map": {
        "negative": 0,
        "neutral": 1,
        "positive": 2
    },
    "inv_label_map": {
        "0": "negative",
        "1": "neutral",
        "2": "positive"
    },
    "experiment_output_dir": "/Users/yefangda/Learning/Courses/Sem2/CS5242/Project/CS5242-Project/output/image_only_bs64"
}
2025-04-19 20:48:09,397 [INFO] Random seed set to 42
2025-04-19 20:48:09,399 [INFO] Creating DataLoaders...
2025-04-19 20:48:09,404 [INFO] Initializing model...
2025-04-19 20:49:04,420 [INFO] Model loaded on device: cpu
2025-04-19 20:49:04,421 [INFO] Setting up optimizer...
2025-04-19 20:49:04,421 [INFO] Optimizing 0 CLIP parameters with LR=1e-06, WD=0.01
2025-04-19 20:49:04,421 [INFO] Optimizing 6 Head parameters with LR=0.0001, WD=0.01
2025-04-19 20:49:04,422 [INFO] --- Starting Training ---
2025-04-19 20:49:04,422 [INFO] 
--- Epoch 1/20 ---
